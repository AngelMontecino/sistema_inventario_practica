{% extends 'base.html' %}

{% block title %}Editar Inventario - Sistema Inventario{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-lg-6 col-md-8">
        
        <div class="mb-4">
        <div class="mb-4">
            <fluent-button appearance="outline" onclick="window.location.href='{% url 'lista_inventario' %}'">
                <i class='bx bx-arrow-back me-1'></i> Volver al inventario
            </fluent-button>
            <h2 class="fw-bold mt-3">Ajustar Stock</h2>
        </div>

        <fluent-card class="p-5">
            <div class="border-bottom pb-3 mb-4">
                <h4 class="mb-0 fw-bold text-primary">
                    <i class='bx bx-box me-2'></i>{{ item.producto.nombre }}
                </h4>
                <p class="text-muted small mt-1 mb-0">ID Inventario: #{{ item.id_inventario }} | Sucursal ID: {{ item.id_sucursal }}</p>
            </div>
            
            {% if error %}
                <div class="alert alert-danger d-flex align-items-center mb-4">
                    <i class='bx bx-error-circle me-2 fs-4'></i>
                    <div>{{ error }}</div>
                </div>
            {% endif %}

            {% if item %}
            <form method="POST">
                {% csrf_token %}
                
                <div class="mb-4">
                    <label for="cantidad" class="form-label small fw-bold text-secondary">Cantidad Actual <span class="text-danger">*</span></label>
                    <div class="input-group input-group-lg">
                        <fluent-button appearance="outline" type="button" onclick="document.getElementById('cantidad').stepDown()" style="min-width: 40px; border-right: 0;">
                            <i class='bx bx-minus'></i>
                        </fluent-button>
                        <input type="number" class="form-control text-center fw-bold border-start-0 border-end-0" id="cantidad" name="cantidad" value="{{ item.cantidad }}" required min="0">
                        <fluent-button appearance="outline" type="button" onclick="document.getElementById('cantidad').stepUp()" style=" min-width: 40px; border-left: 0;">
                            <i class='bx bx-plus'></i>
                        </fluent-button>
                    </div>
                </div>

                <div class="mb-4">
                    <label for="ubicacion_especifica" class="form-label small fw-bold text-secondary">Ubicación Específica</label>
                    <div class="input-group">
                        <span class="input-group-text bg-white border-end-0"><i class='bx bx-map'></i></span>
                        <input type="text" class="form-control border-start-0 ps-0" id="ubicacion_especifica" name="ubicacion_especifica" value="{{ item.ubicacion_especifica|default_if_none:'' }}" placeholder="Ej. Pasillo A, Estante 3">
                    </div>
                </div>

                <div class="row g-3 mb-4">
                    <div class="col-md-6">
                        <label for="stock_minimo" class="form-label fw-bold text-danger small text-uppercase">Stock Mínimo</label>
                        <input type="number" class="form-control" id="stock_minimo" name="stock_minimo" value="{{ item.stock_minimo }}" required min="0">
                    </div>
                    <div class="col-md-6">
                        <label for="stock_maximo" class="form-label fw-bold text-success small text-uppercase">Stock Máximo</label>
                        <input type="number" class="form-control" id="stock_maximo" name="stock_maximo" value="{{ item.stock_maximo|default_if_none:'' }}" min="0">
                    </div>
                </div>

                <div class="d-grid gap-2 d-md-flex justify-content-md-end mt-4">
                     <fluent-button appearance="outline" onclick="window.location.href='{% url 'lista_inventario' %}'">Cancelar</fluent-button>
                    <fluent-button appearance="accent" type="submit">
                        <i class='bx bx-save me-2'></i> Guardar Ajustes
                    </fluent-button>
                </div>
            </form>
            {% else %}
                <div class="alert alert-warning">No se encontraron datos del inventario.</div>
            {% endif %}
        </fluent-card>
    </div>
</div>
{% endblock %}
